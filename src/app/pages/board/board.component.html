<div class="flex flex-col h-screen">
    <app-navbar></app-navbar>
    <div class="w-full grow bg-sky-600 px-4 pb-4">
      <div class="flex flex-col h-full">
        <div>
          <h2 class="text-xl font-bold text-white my-4">Demo Board</h2>
        </div>

        <div class="flex grow items-start w-full h-full overflow-x-auto" cdkDropListGroup>
          @for (column of columnsList; track column; let index = $index) {
            <div class="rounded bg-gray-200 w-72 p-2 mr-3 shrink-0">
              <h3 class="text-sm font-bold ml-2"> {{column.title}} </h3>

              @if (column.tasks.length > 0) {
                <div class="text-sm mt-2 min-h-[2.5rem]" cdkDropList (cdkDropListDropped)="drop($event)"
                    [cdkDropListData]="column.tasks">
                    @for (task of column.tasks; track task.id) {
                      <div
                          (click)="openDialog(task)"
                          cdkDrag
                          class="bg-white shadow p-2 rounded mt-2 cursor-pointer hover:bg-gray-300">
                            {{ task.title }}
                      </div>
                    }
                </div>
              }

              <div>
                @if (!column.showInput) {
                  <div class="flex items-center justify-between my-2">
                    <button class="text-sm text-left  grow text-gray-500 hover:bg-gray-300 rounded px-5 py-2" (click)="column.showInput= !column.showInput">
                      <fa-icon [icon]="faPlus"></fa-icon>
                      Add a Card
                    </button>
                    <button class="text-sm text-gray-500 px-5">
                      <fa-icon [icon]="faImages"></fa-icon>
                    </button>
                  </div>
                } @else {
                    <div class="my-1">
                      <textarea [formControl]="taskName" name="" id="" cols="10" rows="2" class="w-full rounded bg-gray-50 border-gray-300 focus:ring-sky-500"></textarea>
                    </div>
                    <div class="flex justify-between items-center">
                      <div>
                        <button (click)="addCard(index)" class="text-white bg-sky-600 hover:bg-sky-500 font-medium rounded text-sm px-3 py-2">
                          Add Card
                        </button>
                        <button class="ml-3 text-gray-500" (click)="column.showInput = !column.showInput">
                          <fa-icon [icon]="faClose" [size]="'xl'"></fa-icon>
                        </button>
                      </div>
                      <div>
                        <button class="ml-3 text-gray-500">
                          <fa-icon [icon]="faEllipsis" [size]="'xl'"></fa-icon>
                        </button>
                      </div>
                    </div>
                }
              </div>
            </div>
          }
          <div class="w-72 mr-3 shrink-0">
            @if (!isColumnInputShowed) {
              <button class="w-full rounded text-white font-semibold bg-sky-500 hover:bg-sky-400 text-left px-2 py-2" (click)="isColumnInputShowed = !isColumnInputShowed">
                <fa-icon [icon]="faPlus"></fa-icon>
                Add another list
              </button>
            } @else {
              <div class="rounded bg-gray-200 w-72 p-2 mr-3 shrink-0">
                <div class="my-1">
                  <input [formControl]="columnName" name="" id="" class="w-full rounded bg-gray-50 border-gray-300 focus:ring-sky-500"/>
                </div>
                <div class="flex justify-between items-center">
                  <div>
                    <button (click)="addColumn()" class="text-white bg-sky-600 hover:bg-sky-500 font-medium rounded text-sm px-3 py-2">
                      Add list
                    </button>
                    <button class="ml-3 text-gray-500" (click)="isColumnInputShowed = !isColumnInputShowed">
                      <fa-icon [icon]="faClose" [size]="'xl'"></fa-icon>
                    </button>
                  </div>
                </div>
              </div>
            }
          </div>
        </div>
      </div>
    </div>
</div>